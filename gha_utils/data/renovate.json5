{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",
  extends: ["config:recommended", "abandonments:recommended"],

  // Keep lock files up-to-date, including transitive dependencies.
  // Runs on every Renovate execution rather than the default weekly schedule.
  lockFileMaintenance: {
    enabled: true,
    // Rebase whenever main advances, not just on conflicts. A lock file maintenance
    // PR computed against a stale uv.lock baseline is outdated by definition.
    rebaseWhen: "behind-base-branch",
    // Always recreate the branch from scratch instead of attempting a rebase.
    // Lock file maintenance is cheap to recreate (just runs uv lock) and
    // recreation avoids merge conflicts that block stale PRs.
    recreateWhen: "always",
    schedule: ["at any time"],
    semanticCommits: "disabled",
    commitMessageAction: "Sync `uv.lock`",
  },

  // PR and issue settings.
  labels: ["üì¶ dependencies"],
  dependencyDashboardLabels: ["üì¶ dependencies"],

  // Schedule settings.
  timezone: "UTC",
  schedule: ["at any time"],

  // Commit message format: "Update `click` to `<8.4`".
  semanticCommits: "disabled",
  commitMessageTopic: "`{{{depName}}}`",
  commitMessageExtra: "to `{{{newValue}}}`",

  // Stabilization periods. Must be > 7 days to match pyproject.toml's exclude-newer.
  minimumReleaseAge: "8 days",
  packageRules: [
    {
      description: "Major updates have a longer stabilization period.",
      matchUpdateTypes: ["major"],
      minimumReleaseAge: "29 days",
    },
    {
      description: "Minor updates have a moderate stabilization period.",
      matchUpdateTypes: ["minor"],
      minimumReleaseAge: "11 days",
    },
    {
      // Must be > 7 days to match pyproject.toml's exclude-newer buffer.
      description: "Patch updates have a shorter stabilization period.",
      matchUpdateTypes: ["patch"],
      minimumReleaseAge: "8 days",
    },
    {
      description: "Backtick-wrap GitHub Actions names in commit messages.",
      matchManagers: ["github-actions"],
      commitMessageTopic: "`{{{depName}}}` action",
    },
    {
      description: "Flag dependencies with no recent releases.",
      matchCurrentAge: "> 1 year",
      addLabels: ["‚ö†Ô∏è stale dependency"],
    },
    {
      description: "Update SHA-256 checksums after binary version bumps.",
      matchFileNames: [".github/workflows/**"],
      postUpgradeTasks: {
        commands: [
          "pip install uv && uvx --no-progress --from . gha-utils update-checksums {{{packageFile}}}",
        ],
        fileFilters: [".github/workflows/**"],
        executionMode: "update",
      },
    },
    {
      description: "Update exclude-newer date and re-lock during lock file maintenance.",
      matchUpdateTypes: ["lockFileMaintenance"],
      postUpgradeTasks: {
        commands: [
          "pip install uv && uvx --no-progress --from . gha-utils sync-uv-lock",
        ],
        fileFilters: ["pyproject.toml", "uv.lock"],
        executionMode: "update",
      },
    },
  ],

  // Security updates: raise PRs immediately when vulnerabilities are detected.
  // Requires "Dependabot alerts" read permission on the token.
  vulnerabilityAlerts: {
    enabled: true,
    labels: ["üì¶ dependencies", "üí£ security"],
  }
}
